# 基于PSM的DID分析 - 因变量：ln_碳排放量_吨

## 📋 分析概述

本文件夹包含使用**对数碳排放量**作为因变量的DID分析结果。与原始水平值模型相比，对数模型具有更好的经济学解释性（百分比效应）。

### 主要发现 🎯

**DID效应：+8.83%**（p < 0.05，显著）

- **对数形式系数**：0.084606
- **百分比解释**：政策使碳排放量增加8.83%
- **显著性**：** (p = 0.0436)
- **结论**：低碳城市试点政策导致碳排放量**显著上升**

### 与水平值模型对比

| 模型 | 因变量 | DID系数 | 显著性 | 结论 |
|------|--------|---------|--------|------|
| 水平值模型 | 碳排放量_吨 | 478,380.83 | 不显著 (p=0.7149) | 政策无显著影响 |
| **对数模型** | **ln_碳排放量_吨** | **0.084606** | **显著 (p=0.0436)** | **政策显著增加碳排放** |

**重要差异**：对数模型发现了显著的政策效应，而水平值模型未发现！

## 🎯 模型设定

### 因变量
- **ln_碳排放量_吨**：碳排放量的自然对数
- 优势：系数可直接解释为百分比变化
- 缓解异方差问题
- 更接近正态分布

### 核心变量
- **treat**：处理组虚拟变量（1=PSM匹配的处理组城市，0=PSM匹配的对照组城市）
- **post**：时间虚拟变量（1=2009年及以后，0=2009年以前）
- **did**：交互项 = treat × post

### 控制变量
- ln_real_gdp：实际GDP的对数
- ln_人口密度：人口密度的对数
- ln_金融发展水平：金融发展水平的对数
- 第二产业占GDP比重：第二产业占GDP的比重

### 固定效应
- 城市固定效应（145个城市）
- 年份固定效应（17个年份：2007-2023）

### 标准误
- 聚类稳健标准误（聚类到城市层面）

## 📊 主要结果

### 1. 平行趋势检验
⚠️ **限制**：仅有2个政策前年份（2007-2008），无法进行稳健的平行趋势检验

- 处理组斜率：0.052473
- 对照组斜率：0.012080
- 斜率差异：0.040394

### 2. DID回归结果（TWFE模型）

| 变量 | 系数 | 标准误 | t值 | p值 | 显著性 |
|------|------|--------|-----|-----|--------|
| **did** | **0.084606** | **0.041550** | **2.0362** | **0.0436** | **\*\*** |
| ln_real_gdp | 0.0962 | 0.1778 | 0.5411 | 0.5892 |  |
| ln_人口密度 | 0.0380 | 0.1183 | 0.3214 | 0.7484 |  |
| ln_金融发展水平 | 0.0644 | 0.0665 | 0.9679 | 0.3347 |  |
| 第二产业占GDP比重 | （见完整结果） |  |  |  |  |

### 3. 模型拟合优度

- **R-squared**：0.9739（解释力97.39%）
- **Adj. R-squared**：0.9721
- **F-statistic**：520.59 (p < 0.0001)
- **样本数**：2,465个观测值

### 4. 四重差分分析

```
对照组: 16.6277 → 16.9662 (变化: +0.3384)
处理组: 16.5271 → 16.9530 (变化: +0.4260)
─────────────────────────────────────────────
DID效应: 0.0875
```

## 💡 系数解释

### 对数DID系数的经济含义

**DID系数 = 0.084606**

这意味着：
- 政策使ln(碳排放量)变化0.084606个单位
- 百分比变化 = (exp(0.084606) - 1) × 100% = **8.83%**

**解释**：低碳城市试点政策导致处理组城市的碳排放量比对照组城市**多增长8.83%**

### 水平值 vs 对数模型

**水平值模型**：
- 系数：478,380.83吨
- 问题：系数绝对值大，难以判断经济显著性
- p=0.7149，不显著

**对数模型**：
- 系数：8.83%
- 优势：直接反映相对变化，易于解释
- p=0.0436，显著

**为什么对数模型更显著？**
1. 缓解异方差问题
2. 减少极端值影响
3. 更符合经济学假说（弹性关系）
4. 分布更接近正态分布

## ⚠️ 注意事项

### 1. 平行趋势假设
由于仅有2个政策前年份（2007-2008），**无法稳健验证平行趋势假设**。这是本研究的主要限制。

### 2. 政策效应的反直觉性
**研究发现政策使碳排放增加8.83%**，这与"低碳城市"政策的预期相反。可能的原因：

1. **政策效果滞后**：短期可能无法看到减排效果
2. **经济增长抵消**：试点城市经济发展较快，碳排放增长
3. **统计假象**：可能存在其他混淆因素
4. **数据问题**：碳排放数据质量可能有问题
5. **绿色悖论**：政策预期可能导致提前排放

### 3. 模型选择
- 对数模型更显著，但需要考虑哪个模型更合适
- 建议进行稳健性检验

## 📁 文件说明

### 脚本文件
- **01_did_analysis_ln_carbon.py** - 完整DID分析脚本

### 数据文件
- **panel_data_ln_carbon.xlsx** - 面板数据集（217 KB）
  - 包含所有DID变量和控制变量
  - 2,482个观测（146个城市 × 17年）

### 图表文件
- **parallel_trend_ln_carbon.png** - 平行趋势检验图（275 KB）
  - 左图：全期趋势（2007-2023）
  - 右图：政策前放大（2007-2008）

- **did_twfe_results_ln_carbon.png** - 四组均值对比图（104 KB）
  - 处理组/对照组 × 政策前/政策后

### 结果文件
- **did_twfe_results_ln_carbon.txt** - 详细回归结果（2.2 KB）
  - 模型设定
  - 系数估计
  - 显著性检验
  - 经济学解释

## 🚀 使用方法

### 运行分析
```bash
cd c:\Users\HP\Desktop\did-0206\did_analysis_ln_carbon
python 01_did_analysis_ln_carbon.py
```

### 数据要求
- PSM匹配结果：`../psm_analysis_2009/matched_data_2009.xlsx`
- 总数据集：`../总数据集_已合并_含碳排放_new.xlsx`

### 依赖库
- pandas
- numpy
- matplotlib
- scipy
- openpyxl

## 📈 后续分析建议

### 1. 稳健性检验
- 安慰剂检验：随机分配政策时点
- 排除极端值
- 改变时间窗口

### 2. 异质性分析
- 按地区分组（东中西）
- 按城市规模分组
- 按经济发展水平分组

### 3. 机制分析
探索为什么政策导致碳排放增加：
- 产业结构效应？
- 经济增长效应？
- 能源消费效应？

### 4. 动态效应分析
- 事件研究法（Event Study）
- 分年度考察政策效应演化

## 📞 技术信息

**数据来源**：
- PSM匹配：psm_analysis_2009（73对匹配城市）
- 分析期间：2007-2023（17年）
- 政策时点：2009年

**模型类型**：双向固定效应（TWFE）

**统计软件**：Python 3.x + NumPy/Pandas

**生成时间**：2026-02-07

---

**重要提醒**：本分析发现政策显著增加碳排放8.83%，但需注意：
1. 平行趋势假设无法稳健验证
2. 结果与政策预期相反
3. 需要进一步稳健性检验和机制分析
