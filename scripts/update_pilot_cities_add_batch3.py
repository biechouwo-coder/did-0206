"""
更新低碳城市试点名单 - 补充第三批城市
"""

import pandas as pd

print("=" * 100)
print("更新低碳城市试点名单 - 补充第三批城市")
print("=" * 100)

# 定义三批试点数据
# 第一批（2009年启动）
batch_1 = {
    'year': 2009,
    'batch': '第一批',
    'cities': [
        # 单独试点城市
        '天津市', '重庆市', '厦门市', '杭州市', '南昌市', '贵阳市', '保定市',
        # 广东省全境
        '深圳市', '广州市', '珠海市', '汕头市', '佛山市', '江门市', '湛江市', '茂名市',
        '肇庆市', '惠州市', '梅州市', '汕尾市', '河源市', '阳江市', '清远市', '东莞市',
        '中山市', '潮州市', '揭阳市', '云浮市', '韶关市',
        # 辽宁省全境
        '沈阳市', '大连市', '鞍山市', '抚顺市', '本溪市', '丹东市', '锦州市', '营口市',
        '阜新市', '辽阳市', '盘锦市', '铁岭市', '朝阳市', '葫芦岛市',
        # 湖北省全境
        '武汉市', '黄石市', '十堰市', '宜昌市', '襄樊市', '鄂州市', '荆门市', '孝感市',
        '荆州市', '黄冈市', '咸宁市', '随州市', '恩施土家族苗族自治州',
        # 陕西省全境
        '西安市', '铜川市', '宝鸡市', '咸阳市', '渭南市', '延安市', '汉中市', '榆林市',
        '安康市', '商洛市',
        # 云南省全境
        '昆明市', '曲靖市', '玉溪市', '保山市', '昭通市', '丽江市', '普洱市', '临沧市',
        '楚雄彝族自治州', '红河哈尼族彝族自治州', '文山壮族苗族自治州', '西双版纳傣族自治州',
        '大理白族自治州', '德宏傣族景颇族自治州', '怒江傈僳族自治州', '迪庆藏族自治州'
    ]
}

# 第二批（2012年启动）
batch_2 = {
    'year': 2012,
    'batch': '第二批',
    'cities': [
        # 海南省全境
        '海口市', '三亚市',
        # 新增单独试点城市
        '北京市', '上海市', '石家庄市', '秦皇岛市', '晋城市', '呼伦贝尔市', '吉林市',
        '大兴安岭地区', '苏州市', '淮安市', '镇江市', '宁波市', '温州市', '青岛市',
        '济南市', '金昌市', '乌鲁木齐市', '桂林市'
    ]
}

# 第三批（2017年启动）- 补充后
batch_3 = {
    'year': 2017,
    'batch': '第三批',
    'cities': [
        '乌海市', '南京市', '常州市', '无锡市', '嘉兴市', '合肥市', '淮北市', '福州市',
        '南平市', '吉安市', '萍乡市', '淄博市', '郑州市', '焦作市', '三门峡市', '长沙市',
        '株洲市', '湘潭市', '郴州市', '柳州市', '成都市', '广元市', '拉萨市', '兰州市',
        '西宁市', '银川市', '吴忠市', '昌吉回族自治州', '和田地区', '喀什地区',
        # 补充的11个城市
        '金华市', '衢州市', '黄山市', '六安市', '宣城市', '三明市', '赣州市',
        '烟台市', '潍坊市', '遵义市', '济源市'
    ]
}

# 构建数据列表
data = []

# 添加第一批城市
for city in batch_1['cities']:
    data.append({
        '城市名': city,
        '政策实施年': batch_1['year'],
        '批次': batch_1['batch']
    })

# 添加第二批城市
for city in batch_2['cities']:
    data.append({
        '城市名': city,
        '政策实施年': batch_2['year'],
        '批次': batch_2['batch']
    })

# 添加第三批城市
for city in batch_3['cities']:
    data.append({
        '城市名': city,
        '政策实施年': batch_3['year'],
        '批次': batch_3['batch']
    })

# 创建DataFrame
df = pd.DataFrame(data)

# 按批次和城市名排序
df['批次序号'] = df['批次'].map({'第一批': 1, '第二批': 2, '第三批': 3})
df = df.sort_values(['批次序号', '城市名'])
df = df.drop('批次序号', axis=1)

# 保存到Excel
output_file = '../低碳城市试点名单.xlsx'
df.to_excel(output_file, index=False, engine='openpyxl')

print(f"\n数据统计:")
print(f"第一批城市数: {len(batch_1['cities'])}")
print(f"第二批城市数: {len(batch_2['cities'])}")
print(f"第三批城市数: {len(batch_3['cities'])} (原30个 + 补充11个)")
print(f"总计城市数: {len(df)}")

print(f"\n各批次详细统计:")
print(df.groupby('批次').size())

print(f"\n补充的第三批城市:")
added_cities = ['金华市', '衢州市', '黄山市', '六安市', '宣城市', '三明市', '赣州市',
                '烟台市', '潍坊市', '遵义市', '济源市']
for city in added_cities:
    print(f"  - {city}")

print(f"\n文件已保存: {output_file}")

# 显示第三批城市作为预览
print(f"\n第三批城市预览:")
batch3_df = df[df['批次'] == '第三批']
print(batch3_df.to_string(index=False))

# 检查是否有重复城市
duplicates = df[df.duplicated(subset=['城市名'], keep=False)]
if len(duplicates) > 0:
    print(f"\n[注意] 发现重复城市:")
    print(duplicates[['城市名', '批次']].to_string(index=False))
else:
    print(f"\n[OK] 无重复城市")

print("\n" + "=" * 100)
print("更新完成!")
print("=" * 100)
print(f"\n第三批城市数: 30 → 41 (增加11个)")
print(f"总计城市数: 131 → 142")
